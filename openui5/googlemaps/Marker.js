sap.ui.define(["jquery.sap.global","sap/ui/core/Control","google.maps"],function(i,t,n){"use strict";var e=t.extend("openui5.googlemaps.Marker",{metadata:{properties:{lat:{type:"float",bindable:"bindable"},lng:{type:"float",bindable:"bindable"},draggable:{type:"boolean",bindable:"bindable",defaultValue:!1},info:{type:"string",bindable:"bindable"},icon:{type:"sap.ui.core.URI",bindable:"bindable"},animation:{type:"int",bindable:"bindable",defaultValue:n.Animation.DROP}},events:{click:{},dragEnd:{},infoWindowClose:{}},renderer:{}}});return e.prototype.init=function(){this._dragging=!1,this.aListeners=[],this.iwMaxWidth=360},e.prototype.onMapRendered=function(t){this.map=t;var e={};e.position=new n.LatLng(this.getLat(),this.getLng()),e.draggable=this.getDraggable(),e.animation=this.getAnimation(),e.icon=this.getIcon(),this.marker=new n.Marker(e),this.marker.setMap(this.map),this.addListener("click",i.proxy(this.onClick,this)),this.addListener("dragend",i.proxy(this.onDragEnd,this)),this.infoWindow=void 0,this.getInfo()&&(this.infoWindow=new n.InfoWindow({content:this.getInfo(),maxWidth:this.iwMaxWidth}),n.event.addListener(this.infoWindow,"closeclick",i.proxy(this.onInfoWindowClose,this)))},e.prototype.addListener=function(i,t){this.aListeners.push(n.event.addListener(this.marker,i,t))},e.prototype.removeListeners=function(){this.aListeners.forEach(function(i){i.remove()}),this.aListeners=[]},e.prototype.infoWindowOpen=function(t){this.infoWindow.open(this.map,this.marker),t&&i.sap.delayedCall(2e3,this,function(){this.infoWindowclose()})},e.prototype.infoWindowClose=function(){this.infoWindow.close()},e.prototype.onClick=function(){this.infoWindow&&this.infoWindowOpen(),this.fireClick({map:this.map,marker:this.marker,context:this.getBindingContext(),location:{lat:this.getLat(),lng:this.getLng()}})},e.prototype.onDragEnd=function(){var i=this.marker.getPosition();this.setLat(i.lat()),this.setLng(i.lng()),this.fireDragEnd({position:i})},e.prototype.onInfoWindowClose=function(){this.fireInfoWindowClose({})},e.prototype.exit=function(){this.removeListeners(),this.marker.setMap(null)},e},!0);